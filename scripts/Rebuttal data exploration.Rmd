---
title: "Crossing structures data exploration"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE, include=FALSE}

#Script to look at outliers, zeros and autocorrelation

rm(list = ls())

#-----------------Set working directory--------------------
setwd("/Users/hannahedwards/Documents/Alberta Parks/Crossing-structures/data/")
#setwd("/Users/eleonorelebeuf-taylor/Google Drive/Kananaskis crossing structures/")

#----------------Load libraries.-------------
library(MCMCglmm)
library(lmtest)
library(vioplot)
library(zoo)
library(circular)
library(tinytex)
library(regclass)
library(knitr)
library(xts)

#-----------------Load data--------------------
#ungulates.hourly <- read.csv("ungulates hourly.csv")
#ungulates.monthly <- read.csv("ungulates monthly.csv")
#ungulates.annual <- read.csv("ungulates annual.csv")

#carnivores.hourly <- read.csv("carnivores hourly.csv")
#carnivores.monthly <- read.csv("carnivores monthly.csv")
#carnivores.annual <- read.csv("carnivores annual.csv")

#Split by crossing structure type
#Big ungulates
Bigungulates.hourly <- read.csv("Bigungulates hourly.csv")
Bigungulates.hourly.under<-subset(Bigungulates.hourly, Bigungulates.hourly$Underpass.type != "Jumpout")
Bigungulates.hourly.jump<-subset(Bigungulates.hourly, Bigungulates.hourly$Underpass.type != "Underpass")
Bigungulates.monthly <- read.csv("Bigungulates monthly.csv")
Bigungulates.monthly.under<-subset(Bigungulates.monthly, Bigungulates.monthly$Underpass.type != "Jumpout")
Bigungulates.monthly.jump<-subset(Bigungulates.monthly, Bigungulates.monthly$Underpass.type != "Underpass")
Bigungulates.annual <- read.csv("Bigungulates annual.csv")
Bigungulates.annual.under<-subset(Bigungulates.annual, Bigungulates.annual$Underpass.type != "Jumpout")
Bigungulates.annual.jump<-subset(Bigungulates.annual, Bigungulates.annual$Underpass.type != "Underpass")

Smallungulates.hourly <- read.csv("Smallungulates hourly.csv")
Smallungulates.hourly.under<-subset(Smallungulates.hourly, Smallungulates.hourly$Underpass.type != "Jumpout")
Smallungulates.hourly.jump<-subset(Smallungulates.hourly, Smallungulates.hourly$Underpass.type != "Underpass")
Smallungulates.monthly <- read.csv("Smallungulates monthly.csv")
Smallungulates.monthly.under<-subset(Smallungulates.monthly, Smallungulates.monthly$Underpass.type != "Jumpout")
Smallungulates.monthly.jump<-subset(Smallungulates.monthly, Smallungulates.monthly$Underpass.type != "Underpass")
Smallungulates.annual <- read.csv("Smallungulates annual.csv")
Smallungulates.annual.under<-subset(Smallungulates.annual, Smallungulates.annual$Underpass.type != "Jumpout")
Smallungulates.annual.jump<-subset(Smallungulates.annual, Smallungulates.annual$Underpass.type != "Underpass")

Bigcarnivores.hourly <- read.csv("Bigcarnivores hourly.csv")
Bigcarnivores.hourly.under<-subset(Bigcarnivores.hourly, Bigcarnivores.hourly$Underpass.type != "Jumpout")
Bigcarnivores.hourly.jump<-subset(Bigcarnivores.hourly, Bigcarnivores.hourly$Underpass.type != "Underpass")
Bigcarnivores.monthly <- read.csv("Bigcarnivores monthly.csv")
Bigcarnivores.monthly.under<-subset(Bigcarnivores.monthly, Bigcarnivores.monthly$Underpass.type != "Jumpout")
Bigcarnivores.monthly.jump<-subset(Bigcarnivores.monthly, Bigcarnivores.monthly$Underpass.type != "Underpass")
Bigcarnivores.annual <- read.csv("Bigcarnivores annual.csv")
Bigcarnivores.annual.under<-subset(Bigcarnivores.annual, Bigcarnivores.annual$Underpass.type != "Jumpout")
Bigcarnivores.annual.jump<-subset(Bigcarnivores.annual, Bigcarnivores.annual$Underpass.type != "Underpass")

Smallcarnivores.hourly <- read.csv("Smallcarnivores hourly.csv")
Smallcarnivores.hourly.under<-subset(Smallcarnivores.hourly, Smallcarnivores.hourly$Underpass.type != "Jumpout")
Smallcarnivores.hourly.jump<-subset(Smallcarnivores.hourly, Smallcarnivores.hourly$Underpass.type != "Underpass")
Smallcarnivores.monthly <- read.csv("Smallcarnivores monthly.csv")
Smallcarnivores.monthly.under<-subset(Smallcarnivores.monthly, Smallcarnivores.monthly$Underpass.type != "Jumpout")
Smallcarnivores.monthly.jump<-subset(Smallcarnivores.monthly, Smallcarnivores.monthly$Underpass.type != "Underpass")
Smallcarnivores.annual <- read.csv("Smallcarnivores annual.csv")
Smallcarnivores.annual.under<-subset(Smallcarnivores.annual, Smallcarnivores.annual$Underpass.type != "Jumpout")
Smallcarnivores.annual.jump<-subset(Smallcarnivores.annual, Smallcarnivores.annual$Underpass.type != "Underpass")

```

# Look for outliers in datasets split by species size and hour/month/year 

## Annual large carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Bigcarnivores.annual$Total)
```
## Annual small carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Smallcarnivores.annual$Total)
```
## Monthly large carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Bigcarnivores.monthly$Total)
```
## Monthly small carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Smallcarnivores.monthly$Total)
```
## Hourly large carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Bigcarnivores.hourly$Total)
```
## Hourly small carnivore 
```{r, eval=TRUE, echo=FALSE}
summary(Smallcarnivores.hourly$Total)
```
## Annual large ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Bigungulates.annual$Total)
```
## Annual small ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Smallungulates.annual$Total)
```
## Monthly large ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Bigungulates.monthly$Total)
```
## Monthly small ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Smallungulates.monthly$Total)
```
## Hourly large ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Bigungulates.hourly$Total)
```
## Hourly small ungulate
```{r, eval=TRUE, echo=FALSE}
summary(Smallungulates.hourly$Total)
```
# Look for zeros in the data

## Proportion of zeros in the carnivore dataset
```{r, eval=TRUE, echo=FALSE}
Annual_bigcarnivore_count_underpass<-sum(Bigcarnivores.annual.under$Total == 0)/length(Bigcarnivores.annual.under$Total) 
Annual_smallcarnivore_count_underpass<-sum(Smallcarnivores.annual.under$Total == 0)/length(Smallcarnivores.annual.under$Total) 
#Annual carnivore count for jumpouts
Annual_bigcarnivore_count_jumpout<-sum(Bigcarnivores.annual.jump$Total == 0)/length(Bigcarnivores.annual.jump$Total)  
Annual_smallcarnivore_count_jumpout<-sum(Smallcarnivores.annual.jump$Total == 0)/length(Smallcarnivores.annual.jump$Total)  
#Monthly carnivore count for underpasses
Monthly_bigcarnivore_count_underpass<-sum(Bigcarnivores.monthly.under$Total == 0)/length(Bigcarnivores.monthly.under$Total)  
Monthly_smallcarnivore_count_underpass<-sum(Smallcarnivores.monthly.under$Total == 0)/length(Smallcarnivores.monthly.under$Total)  
#Monthly carnivore count for jumpouts
Monthly_bigcarnivore_count_jumpout<-sum(Bigcarnivores.monthly.jump$Total == 0)/length(Bigcarnivores.monthly.jump$Total) 
Monthly_smallcarnivore_count_jumpout<-sum(Smallcarnivores.monthly.jump$Total == 0)/length(Smallcarnivores.monthly.jump$Total) 
#Hourly carnivore count for underpasses
Hourly_bigcarnivore_count_underpass<-sum(Bigcarnivores.hourly.under$Total == 0)/length(Bigcarnivores.hourly.under$Total)
Hourly_smallcarnivore_count_underpass<-sum(Smallcarnivores.hourly.under$Total == 0)/length(Smallcarnivores.hourly.under$Total)  
#Hourly carnivore count for jumpouts
Hourly_bigcarnivore_count_jumpout<-sum(Bigcarnivores.hourly.jump$Total == 0)/length(Bigcarnivores.hourly.jump$Total)  
Hourly_smallcarnivore_count_jumpout<-sum(Smallcarnivores.hourly.jump$Total == 0)/length(Smallcarnivores.hourly.jump$Total)  

Table1<-rbind(Annual_bigcarnivore_count_jumpout, Annual_bigcarnivore_count_underpass, Monthly_bigcarnivore_count_jumpout, Monthly_bigcarnivore_count_underpass, 
      Hourly_bigcarnivore_count_jumpout, Hourly_bigcarnivore_count_underpass, Annual_smallcarnivore_count_jumpout, Annual_smallcarnivore_count_underpass, Monthly_smallcarnivore_count_jumpout, Monthly_smallcarnivore_count_underpass, 
      Hourly_smallcarnivore_count_jumpout, Hourly_smallcarnivore_count_underpass)
Table1<-round(Table1, digits=2)
colnames(Table1)[1]  <- "Proportion of zeros"
kable(Table1, caption="Number of zeros in the dataset divided by the dataset sample size")

```

## Proportion of zeros in the ungulate dataset
```{r, eval=TRUE, echo=FALSE}

Annual_bigungulate_count_underpass<-sum(Bigungulates.annual.under$Total == 0)/length(Bigungulates.annual.under$Total)
Annual_smallungulate_count_underpass<-sum(Smallungulates.annual.under$Total == 0)/length(Smallungulates.annual.under$Total)
#Annual ungulate count for jumpouts
Annual_bigungulate_count_jumpout<-sum(Bigungulates.annual.jump$Total == 0)/length(Bigungulates.annual.jump$Total) 
Annual_smallungulate_count_jumpout<-sum(Smallungulates.annual.jump$Total == 0)/length(Smallungulates.annual.jump$Total) 
#Monthly ungulate count for underpasses
Monthly_bigungulate_count_underpass<-sum(Bigungulates.monthly.under$Total == 0)/length(Bigungulates.monthly.under$Total) 
Monthly_smallungulate_count_underpass<-sum(Smallungulates.monthly.under$Total == 0)/length(Smallungulates.monthly.under$Total) 
#Monthly ungulate count for jumpouts
Monthly_bigungulate_count_jumpout<-sum(Bigungulates.monthly.jump$Total == 0)/length(Bigungulates.monthly.jump$Total)  
Monthly_smallungulate_count_jumpout<-sum(Smallungulates.monthly.jump$Total == 0)/length(Smallungulates.monthly.jump$Total)  
#Hourly ungulate count for underpasses
Hourly_bigungulate_count_underpass<-sum(Bigungulates.hourly.under$Total == 0)/length(Bigungulates.hourly.under$Total)  
Hourly_smallungulate_count_underpass<-sum(Smallungulates.hourly.under$Total == 0)/length(Smallungulates.hourly.under$Total)  
#Hourly ungulate count for jumpouts
Hourly_bigungulate_count_jumpout<-sum(Bigungulates.hourly.jump$Total == 0)/length(Bigungulates.hourly.jump$Total)  
Hourly_smallungulate_count_jumpout<-sum(Smallungulates.hourly.jump$Total == 0)/length(Smallungulates.hourly.jump$Total)  

Table2<-rbind(Annual_bigungulate_count_jumpout, Annual_bigungulate_count_underpass, Monthly_bigungulate_count_jumpout, Monthly_bigungulate_count_underpass, 
      Hourly_bigungulate_count_jumpout, Hourly_bigungulate_count_underpass, Annual_smallungulate_count_jumpout, Annual_smallungulate_count_underpass, Monthly_smallungulate_count_jumpout, Monthly_smallungulate_count_underpass, 
      Hourly_smallungulate_count_jumpout, Hourly_smallungulate_count_underpass)
Table2<-round(Table2, digits=2)
colnames(Table2)[1]  <- "Proportion of zeros"
kable(Table2, caption="Number of zeros in the dataset divided by the dataset sample size")

```

# Check for autocorrelation
## Run Box-Pierce and Ljung-Box test on the raw data
## Build a model of the mean (lm(count~1)) and run Durbin Watson test to test residuals
## Look at the variance and the mean

## Annual big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.ann.count.jump<-Bigcarnivores.annual.jump$Total
Bigcar.ann.count.jump.mod <- lm(Bigcar.ann.count.jump ~ 1)
dwtest(Bigcar.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.ann.count.jump, xlab="Lag" , main="Figure 1: Total big carnivore annual count for jumpouts") #plot acf
```

## Annual small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.ann.count.jump<-Smallcarnivores.annual.jump$Total
Smallcar.ann.count.jump.mod <- lm(Smallcar.ann.count.jump ~ 1)
dwtest(Smallcar.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.ann.count.jump, xlab="Lag", main="Figure 2: Total small carnivore annual count for jumpouts") #plot acf

```

## Annual big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.ann.count.under<-Bigcarnivores.annual.under$Total
Bigcar.ann.count.under.mod <- lm(Bigcar.ann.count.under ~ 1)
dwtest(Bigcar.ann.count.under.mod) #not autocorrelated
Box.test(Bigcar.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.ann.count.under,  xlab="Lag",
    main="Figure 3: Total big carnivore annual count for underpasses")
```

## Annual small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.ann.count.under<-Smallcarnivores.annual.under$Total
Smallcar.ann.count.under.mod <- lm(Smallcar.ann.count.under ~ 1)
dwtest(Smallcar.ann.count.under.mod) #not autocorrelated
Box.test(Smallcar.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.ann.count.under, xlab="Lag",
    main="Figure 4: Total small carnivore annual count for underpasses")
```

## Monthly big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.mon.count.jump<-Bigcarnivores.monthly.jump$Total
Bigcar.mon.count.jump.mod <- lm(Bigcar.mon.count.jump ~ 1)
dwtest(Bigcar.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.mon.count.jump, xlab="Lag",
    main="Figure 5:Total big carnivore monthly count for jumpouts") #plot acf

```

## Monthly small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.mon.count.jump<-Smallcarnivores.monthly.jump$Total
Smallcar.mon.count.jump.mod <- lm(Smallcar.mon.count.jump ~ 1)
dwtest(Smallcar.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.mon.count.jump, xlab="Lag",
    main="Figure 6:Total small carnivore monthly count for jumpouts") #plot acf

```

## Monthly big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.mon.count.under<-Bigcarnivores.monthly.under$Total
Bigcar.mon.count.under.mod <- lm(Bigcar.mon.count.under ~ 1)
dwtest(Bigcar.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.mon.count.under, xlab="Lag",
    main="Figure 7:Total big carnivore monthly count for underpasses") #plot acf

```

## Monthly small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.mon.count.under<-Smallcarnivores.monthly.under$Total
Smallcar.mon.count.under.mod <- lm(Smallcar.mon.count.under ~ 1)
dwtest(Smallcar.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.mon.count.under, xlab="Lag",
    main="Figure 8:Total small carnivore monthly count for underpasses") #plot acf

```

## Hourly big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.hou.count.jump<-Bigcarnivores.hourly.jump$Total
Bigcar.hou.count.jump.mod <- lm(Bigcar.hou.count.jump ~ 1)
dwtest(Bigcar.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.hou.count.jump, xlab="Lag",
    main="Figure 9:Total big carnivore hourly count for jumpouts") #plot acf

```

## Hourly small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.hou.count.jump<-Smallcarnivores.hourly.jump$Total
Smallcar.hou.count.jump.mod <- lm(Smallcar.hou.count.jump ~ 1)
dwtest(Smallcar.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.hou.count.jump, xlab="Lag",
    main="Figure 10:Total small carnivore hourly count for jumpouts") #plot acf

```

## Hourly big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.hou.count.under<-Bigcarnivores.hourly.under$Total
Bigcar.hou.count.under.mod <- lm(Bigcar.hou.count.under ~ 1)
dwtest(Bigcar.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.hou.count.under, xlab="Lag",
    main="Figure 11:Total big carnivore hourly count for underpasses") #plot acf

```

##Hourly small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.hou.count.under<-Smallcarnivores.hourly.under$Total
Smallcar.hou.count.under.mod <- lm(Smallcar.hou.count.under ~ 1)
dwtest(Smallcar.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.hou.count.under, xlab="Lag",
    main="Figure 12:Total small carnivore hourly count for underpasses") #plot acf

```

## Annual big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.ann.count.jump<-Bigungulates.annual.jump$Total
Bigung.ann.count.jump.mod <- lm(Bigung.ann.count.jump ~ 1)
dwtest(Bigung.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.ann.count.jump, xlab="Lag",
    main="Figure 13:Total small carnivore hourly count for jumpouts") #plot acf

```

## Annual small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.ann.count.jump<-Smallungulates.annual.jump$Total
Smallung.ann.count.jump.mod <- lm(Smallung.ann.count.jump ~ 1)
dwtest(Smallung.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.ann.count.jump, xlab="Lag",
    main="Figure 14:Total small ungulates annual count for jumpouts") #plot acf
```

## Annual big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.ann.count.under<-Bigungulates.annual.under$Total
Bigung.ann.count.under.mod <- lm(Bigung.ann.count.under ~ 1)
dwtest(Bigung.ann.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.ann.count.under, xlab="Lag",
    main="Figure 15:Total big ungulates annual count for underpasses") #plot acf

```

## Annual small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.ann.count.under<-Smallungulates.annual.under$Total
Smallung.ann.count.under.mod <- lm(Smallung.ann.count.under ~ 1)
dwtest(Smallung.ann.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.ann.count.under, xlab="Lag",
    main="Figure 16:Total small ungulates annual count for underpasses") #plot acf

```

## Monthly big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.mon.count.jump<-Bigungulates.monthly.jump$Total
Bigung.mon.count.jump.mod <- lm(Bigung.mon.count.jump ~ 1)
dwtest(Bigung.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.mon.count.jump, xlab="Lag",
    main="Figure 17:Total big ungulates monthly count for jumpouts") #plot acf

```

## Monthly small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.mon.count.jump<-Smallungulates.monthly.jump$Total
Smallung.mon.count.jump.mod <- lm(Smallung.mon.count.jump ~ 1)
dwtest(Smallung.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.mon.count.jump, xlab="Lag",
    main="Figure 18:Total small ungulates monthly count for jumpouts") #plot acf

```

## Monthly big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.mon.count.under<-Bigungulates.monthly.under$Total
Bigung.mon.count.under.mod <- lm(Bigung.mon.count.under ~ 1)
dwtest(Bigung.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.mon.count.under, xlab="Lag",
    main="Figure 19:Total big ungulates monthly count for underpasses") #plot acf

```

## Monthly small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.mon.count.under<-Smallungulates.monthly.under$Total
Smallung.mon.count.under.mod <- lm(Smallung.mon.count.under ~ 1)
dwtest(Smallung.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.mon.count.under, xlab="Lag",
    main="Figure 20:Total small ungulates monthly count for underpasses") #plot acf

```

## Hourly big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.hou.count.jump<-Bigungulates.hourly.jump$Total
Bigung.hou.count.jump.mod <- lm(Bigung.hou.count.jump ~ 1)
dwtest(Bigung.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.hou.count.jump, xlab="Lag",
    main="Figure 21:Total big ungulates hourly count for jumpouts") #plot acf

```

## Hourly small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.hou.count.jump<-Smallungulates.hourly.jump$Total
Smallung.hou.count.jump.mod <- lm(Smallung.hou.count.jump ~ 1)
dwtest(Smallung.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.hou.count.jump, xlab="Lag",
    main="Figure 22:Total small ungulates hourly count for jumpouts") #plot acf

```

## Hourly big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.hou.count.under<-Bigungulates.hourly.under$Total
Bigung.hou.count.under.mod <- lm(Bigung.hou.count.under ~ 1)
dwtest(Bigung.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.hou.count.under, xlab="Lag",
    main="Figure 23:Total big ungulates hourly count for underpasses") #plot acf

```

## Hourly small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.hou.count.under<-Smallungulates.hourly.under$Total
Smallung.hou.count.under.mod <- lm(Smallung.hou.count.under ~ 1)
dwtest(Smallung.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.hou.count.under, xlab="Lag",
    main="Figure 24:Total small ungulates hourly count for underpasses") #plot acf

```

# Look at whether there is circularity in the dataset

```{r, echo=FALSE}
#Setup the data differently, get frequencies of count for hour/month/year
newdata<-read.csv("/Users/hannahedwards/Documents/Alberta Parks/Crossing-structures/data/newdata_bodymass.csv")

#Split by species and then crossing structure
smallungulates.under<-subset(newdata, newdata$Species.body.mass == "Small ungulate" &
                                 newdata$Underpass.type == "Underpass")
bigungulates.under<-subset(newdata, newdata$Species.body.mass == "Big ungulate" &
                                 newdata$Underpass.type == "Underpass")
smallungulates.jump<-subset(newdata, newdata$Species.body.mass == "Small ungulate" &
                                 newdata$Underpass.type == "Jumpout")
bigungulates.jump<-subset(newdata, newdata$Species.body.mass == "Big ungulate" &
                                 newdata$Underpass.type == "Jumpout")

smallcarnivores.under<-subset(newdata, newdata$Species.body.mass == "Small carnivore" &
                                 newdata$Underpass.type == "Underpass")
bigcarnivores.under<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                                 newdata$Underpass.type == "Underpass")
smallcarnivores.jump<-subset(newdata, newdata$Species.body.mass == "Small carnivore" &
                          newdata$Underpass.type == "Jumpout")
bigcarnivores.jump<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                          newdata$Underpass.type == "Jumpout")
carnivores<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                     newdata$Species.body.mass == "Small carnivore")

Bobcat<-subset(newdata, newdata$Species == "Bobcat")
Cougar<-subset(newdata, newdata$Species == "Cougar")
Coyote<-subset(newdata, newdata$Species == "Coyote")
GrizzlyBear<-subset(newdata, newdata$Species == "Grizzly Bear")
Lynx<-subset(newdata, newdata$Species == "Lynx")
Marten<-subset(newdata, newdata$Species == "Marten")
RedFox<-subset(newdata, newdata$Species == "Red Fox")
StripedSkunk<-subset(newdata, newdata$Species == "Striped Skunk")
UnknownBear<-subset(newdata, newdata$Species == "Unknown Bear")
Wolf<-subset(newdata, newdata$Species == "Wolf")
Wolverine<-subset(newdata, newdata$Species == "Wolverine")
BlackBear<-subset(newdata, newdata$Species == "Black Bear")
```

## Ungulate and carnivore hours of activity

```{r, eval=TRUE, echo=FALSE}
#Make data circular with hourending
#Vector
#Underpass
bigunghourunder<-bigungulates.under$HourEnding
smallunghourunder<-smallungulates.under$HourEnding
bigcarhourunder<-bigcarnivores.under$HourEnding
smallcarhourunder<-smallcarnivores.under$HourEnding
bigunghourunderc <- circular(bigunghourunder, units="hours", template="clock24")
smallunghourunderc <- circular(smallunghourunder, units="hours", template="clock24")
bigcarhourunderc <- circular(bigcarhourunder, units="hours", template="clock24")
smallcarhourunderc <- circular(smallcarhourunder, units="hours", template="clock24")
#Jumpout
bigunghourjump<-bigungulates.jump$HourEnding
smallunghourjump<-smallungulates.jump$HourEnding
bigcarhourjump<-bigcarnivores.jump$HourEnding
smallcarhourjump<-smallcarnivores.jump$HourEnding
bigunghourjumpc <- circular(bigunghourjump, units="hours", template="clock24")
smallunghourjumpc <- circular(smallunghourjump, units="hours", template="clock24")
bigcarhourjumpc <- circular(bigcarhourjump, units="hours", template="clock24")
smallcarhourjumpc <- circular(smallcarhourjump, units="hours", template="clock24")
#the radius of a segment is taken to be the square root of the relative frequency
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigunghourunderc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(bigunghourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate hour frequency underpasses", main="Figure 26")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallunghourunderc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(smallunghourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate hour frequency underpasses", main="Figure 27")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigunghourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(bigunghourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate hour frequency jumpouts", main="Figure 28")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallunghourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(smallunghourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate hour frequency jumpouts", main="Figure 29")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarhourunderc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(bigcarhourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore hour frequency underpasses", main="Figure 30")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarhourunderc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(smallcarhourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore hour frequency underpasses", main="Figure 31")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarhourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(bigcarhourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore hour frequency jumpouts", main="Figure 32")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarhourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(smallcarhourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore hour frequency jumpouts", main="Figure 33")
```

## Ungulate and carnivore months of activity

```{r, eval=TRUE, echo=FALSE}
#Make data circular with Month
#Underpass
bigungmonunder<-bigungulates.under$Month
smallungmonunder<-smallungulates.under$Month
bigcarmonunder<-bigcarnivores.under$Month
smallcarmonunder<-smallcarnivores.under$Month
bigungmonunderc <- circular(bigungmonunder, units="hours", template="clock12")
smallungmonunderc <- circular(smallungmonunder, units="hours", template="clock12")
bigcarmonunderc <- circular(bigcarmonunder, units="hours", template="clock12")
smallcarmonunderc <- circular(smallcarmonunder, units="hours", template="clock12")
#Jumpout
bigungmonjump<-bigungulates.jump$Month
smallungmonjump<-smallungulates.jump$Month
bigcarmonjump<-bigcarnivores.jump$Month
smallcarmonjump<-smallcarnivores.jump$Month
bigungmonjumpc <- circular(bigungmonjump, units="hours", template="clock12")
smallungmonjumpc <- circular(smallungmonjump, units="hours", template="clock12")
bigcarmonjumpc <- circular(bigcarmonjump, units="hours", template="clock12")
smallcarmonjumpc <- circular(smallcarmonjump, units="hours", template="clock12")

#the radius of a segment is taken to be the square root of the relative frequency
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigungmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(bigungmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate month frequency jumpouts", main="Figure 34")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallungmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(smallungmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate month frequency jumpouts", main="Figure 35")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigungmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigungmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulates month frequency underpasses", main="Figure 36")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallungmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallungmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulates month frequency underpasses", main="Figure 37")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigcarmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore month frequency jumpouts", main="Figure 38")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallcarmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore month frequency jumpouts", main="Figure 39")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigcarmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore month frequency underpasses", main="Figure 40")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallcarmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore month frequency underpasses", main="Figure 41")
```

