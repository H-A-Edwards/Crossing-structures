---
title: "Crossing structures data exploration"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE, include=FALSE}

#Script to look at outliers, zeros and autocorrelation

rm(list = ls())

#-----------------Set working directory--------------------
setwd("/Users/hannahedwards/Documents/Alberta Parks/Crossing-structures/data/")
#setwd("/Users/eleonorelebeuf-taylor/Google Drive/Kananaskis crossing structures/")

#----------------Load libraries.-------------
library(MCMCglmm)
library(lmtest)
library(vioplot)
library(zoo)
library(circular)
library(tinytex)
library(regclass)
library(knitr)
library(xts)

#-----------------Load data--------------------
#ungulates.hourly <- read.csv("ungulates hourly.csv")
#ungulates.monthly <- read.csv("ungulates monthly.csv")
#ungulates.annual <- read.csv("ungulates annual.csv")

#carnivores.hourly <- read.csv("carnivores hourly.csv")
#carnivores.monthly <- read.csv("carnivores monthly.csv")
#carnivores.annual <- read.csv("carnivores annual.csv")

#Split by crossing structure type
#Big ungulates
Bigungulates.hourly <- read.csv("Bigungulates hourly.csv")
Bigungulates.hourly.under<-subset(Bigungulates.hourly, Bigungulates.hourly$Underpass.type != "Jumpout")
Bigungulates.hourly.jump<-subset(Bigungulates.hourly, Bigungulates.hourly$Underpass.type != "Underpass")
Bigungulates.monthly <- read.csv("Bigungulates monthly.csv")
Bigungulates.monthly.under<-subset(Bigungulates.monthly, Bigungulates.monthly$Underpass.type != "Jumpout")
Bigungulates.monthly.jump<-subset(Bigungulates.monthly, Bigungulates.monthly$Underpass.type != "Underpass")
Bigungulates.annual <- read.csv("Bigungulates annual.csv")
Bigungulates.annual.under<-subset(Bigungulates.annual, Bigungulates.annual$Underpass.type != "Jumpout")
Bigungulates.annual.jump<-subset(Bigungulates.annual, Bigungulates.annual$Underpass.type != "Underpass")

Smallungulates.hourly <- read.csv("Smallungulates hourly.csv")
Smallungulates.hourly.under<-subset(Smallungulates.hourly, Smallungulates.hourly$Underpass.type != "Jumpout")
Smallungulates.hourly.jump<-subset(Smallungulates.hourly, Smallungulates.hourly$Underpass.type != "Underpass")
Smallungulates.monthly <- read.csv("Smallungulates monthly.csv")
Smallungulates.monthly.under<-subset(Smallungulates.monthly, Smallungulates.monthly$Underpass.type != "Jumpout")
Smallungulates.monthly.jump<-subset(Smallungulates.monthly, Smallungulates.monthly$Underpass.type != "Underpass")
Smallungulates.annual <- read.csv("Smallungulates annual.csv")
Smallungulates.annual.under<-subset(Smallungulates.annual, Smallungulates.annual$Underpass.type != "Jumpout")
Smallungulates.annual.jump<-subset(Smallungulates.annual, Smallungulates.annual$Underpass.type != "Underpass")

Bigcarnivores.hourly <- read.csv("Bigcarnivores hourly.csv")
Bigcarnivores.hourly.under<-subset(Bigcarnivores.hourly, Bigcarnivores.hourly$Underpass.type != "Jumpout")
Bigcarnivores.hourly.jump<-subset(Bigcarnivores.hourly, Bigcarnivores.hourly$Underpass.type != "Underpass")
Bigcarnivores.monthly <- read.csv("Bigcarnivores monthly.csv")
Bigcarnivores.monthly.under<-subset(Bigcarnivores.monthly, Bigcarnivores.monthly$Underpass.type != "Jumpout")
Bigcarnivores.monthly.jump<-subset(Bigcarnivores.monthly, Bigcarnivores.monthly$Underpass.type != "Underpass")
Bigcarnivores.annual <- read.csv("Bigcarnivores annual.csv")
Bigcarnivores.annual.under<-subset(Bigcarnivores.annual, Bigcarnivores.annual$Underpass.type != "Jumpout")
Bigcarnivores.annual.jump<-subset(Bigcarnivores.annual, Bigcarnivores.annual$Underpass.type != "Underpass")

Smallcarnivores.hourly <- read.csv("Smallcarnivores hourly.csv")
Smallcarnivores.hourly.under<-subset(Smallcarnivores.hourly, Smallcarnivores.hourly$Underpass.type != "Jumpout")
Smallcarnivores.hourly.jump<-subset(Smallcarnivores.hourly, Smallcarnivores.hourly$Underpass.type != "Underpass")
Smallcarnivores.monthly <- read.csv("Smallcarnivores monthly.csv")
Smallcarnivores.monthly.under<-subset(Smallcarnivores.monthly, Smallcarnivores.monthly$Underpass.type != "Jumpout")
Smallcarnivores.monthly.jump<-subset(Smallcarnivores.monthly, Smallcarnivores.monthly$Underpass.type != "Underpass")
Smallcarnivores.annual <- read.csv("Smallcarnivores annual.csv")
Smallcarnivores.annual.under<-subset(Smallcarnivores.annual, Smallcarnivores.annual$Underpass.type != "Jumpout")
Smallcarnivores.annual.jump<-subset(Smallcarnivores.annual, Smallcarnivores.annual$Underpass.type != "Underpass")

```

# Look for outliers in guild 

```{r, eval=TRUE, echo=FALSE}
summary(Bigcarnivores.annual$Total)
hist(Bigcarnivores.annual$Total, xlab="Total annual big carnivore count per crossing structure",
      ylim=c(0,50), main="Figure 1")

summary(Smallcarnivores.annual$Total)
hist(Smallcarnivores.annual$Total, xlab="Total annual small carnivore count per crossing structure",
      ylim=c(0,50), main="Figure 2")

summary(Bigcarnivores.monthly$Total)
hist(Bigcarnivores.monthly$Total, xlab="Total monthly big carnivore count per crossing structure",
     ylim=c(0,60), main="Figure 3")

summary(Smallcarnivores.monthly$Total)
hist(Smallcarnivores.monthly$Total, xlab="Total monthly small carnivore count per crossing structure",
     ylim=c(0,60), main="Figure 4")

summary(Bigcarnivores.hourly$Total)
hist(Bigcarnivores.hourly$Total, xlab="Total hourly big carnivore count per crossing structure",
     ylim=c(0,100), main="Figure 5")

summary(Smallcarnivores.hourly$Total)
hist(Smallcarnivores.hourly$Total, xlab="Total hourly small carnivore count per crossing structure",
     ylim=c(0,100), main="Figure 6")

summary(Bigungulates.annual$Total)
hist(Bigungulates.annual$Total, xlab="Total annual big ungulate count per crossing structure",
     ylim=c(0,50), main="Figure 7")

summary(Smallungulates.annual$Total)
hist(Smallungulates.annual$Total, xlab="Total annual small ungulate count per crossing structure",
     ylim=c(0,50), main="Figure 8")

summary(Bigungulates.monthly$Total)
hist(Bigungulates.monthly$Total, xlab="Total monthly big ungulate count per crossing structure",
     ylim=c(0,60), main="Figure 9")

summary(Smallungulates.monthly$Total)
hist(Smallungulates.monthly$Total, xlab="Total monthly small ungulate count per crossing structure",
     ylim=c(0,60), main="Figure 10")

summary(Bigungulates.hourly$Total)
hist(Bigungulates.hourly$Total, xlab="Total hourly big ungulate count per crossing structure",
     ylim=c(0,100), main="Figure 11")

summary(Smallungulates.hourly$Total)
hist(Smallungulates.hourly$Total, xlab="Total hourly small ungulate count per crossing structure",
     ylim=c(0,100), main="Figure 12")

```
# Look for zeros in the data

## Proportion of zeros in the carnivore dataset
```{r, eval=TRUE, echo=FALSE}
Annual_bigcarnivore_count_underpass<-sum(Bigcarnivores.annual.under$Total == 0)/length(Bigcarnivores.annual.under$Total) 
Annual_smallcarnivore_count_underpass<-sum(Smallcarnivores.annual.under$Total == 0)/length(Smallcarnivores.annual.under$Total) 
#Annual carnivore count for jumpouts
Annual_bigcarnivore_count_jumpout<-sum(Bigcarnivores.annual.jump$Total == 0)/length(Bigcarnivores.annual.jump$Total)  
Annual_smallcarnivore_count_jumpout<-sum(Smallcarnivores.annual.jump$Total == 0)/length(Smallcarnivores.annual.jump$Total)  
#Monthly carnivore count for underpasses
Monthly_bigcarnivore_count_underpass<-sum(Bigcarnivores.monthly.under$Total == 0)/length(Bigcarnivores.monthly.under$Total)  
Monthly_smallcarnivore_count_underpass<-sum(Smallcarnivores.monthly.under$Total == 0)/length(Smallcarnivores.monthly.under$Total)  
#Monthly carnivore count for jumpouts
Monthly_bigcarnivore_count_jumpout<-sum(Bigcarnivores.monthly.jump$Total == 0)/length(Bigcarnivores.monthly.jump$Total) 
Monthly_smallcarnivore_count_jumpout<-sum(Smallcarnivores.monthly.jump$Total == 0)/length(Smallcarnivores.monthly.jump$Total) 
#Hourly carnivore count for underpasses
Hourly_bigcarnivore_count_underpass<-sum(Bigcarnivores.hourly.under$Total == 0)/length(Bigcarnivores.hourly.under$Total)
Hourly_smallcarnivore_count_underpass<-sum(Smallcarnivores.hourly.under$Total == 0)/length(Smallcarnivores.hourly.under$Total)  
#Hourly carnivore count for jumpouts
Hourly_bigcarnivore_count_jumpout<-sum(Bigcarnivores.hourly.jump$Total == 0)/length(Bigcarnivores.hourly.jump$Total)  
Hourly_smallcarnivore_count_jumpout<-sum(Smallcarnivores.hourly.jump$Total == 0)/length(Smallcarnivores.hourly.jump$Total)  

Table1<-rbind(Annual_bigcarnivore_count_jumpout, Annual_bigcarnivore_count_underpass, Monthly_bigcarnivore_count_jumpout, Monthly_bigcarnivore_count_underpass, 
      Hourly_bigcarnivore_count_jumpout, Hourly_bigcarnivore_count_underpass, Annual_smallcarnivore_count_jumpout, Annual_smallcarnivore_count_underpass, Monthly_smallcarnivore_count_jumpout, Monthly_smallcarnivore_count_underpass, 
      Hourly_smallcarnivore_count_jumpout, Hourly_smallcarnivore_count_underpass)
Table1<-round(Table1, digits=2)
colnames(Table1)[1]  <- "Proportion of zeros"
kable(Table1, caption="Number of zeros in the dataset divided by the dataset sample size")

```

## Proportion of zeros in the ungulate dataset
```{r, eval=TRUE, echo=FALSE}

Annual_bigungulate_count_underpass<-sum(Bigungulates.annual.under$Total == 0)/length(Bigungulates.annual.under$Total)
Annual_smallungulate_count_underpass<-sum(Smallungulates.annual.under$Total == 0)/length(Smallungulates.annual.under$Total)
#Annual ungulate count for jumpouts
Annual_bigungulate_count_jumpout<-sum(Bigungulates.annual.jump$Total == 0)/length(Bigungulates.annual.jump$Total) 
Annual_smallungulate_count_jumpout<-sum(Smallungulates.annual.jump$Total == 0)/length(Smallungulates.annual.jump$Total) 
#Monthly ungulate count for underpasses
Monthly_bigungulate_count_underpass<-sum(Bigungulates.monthly.under$Total == 0)/length(Bigungulates.monthly.under$Total) 
Monthly_smallungulate_count_underpass<-sum(Smallungulates.monthly.under$Total == 0)/length(Smallungulates.monthly.under$Total) 
#Monthly ungulate count for jumpouts
Monthly_bigungulate_count_jumpout<-sum(Bigungulates.monthly.jump$Total == 0)/length(Bigungulates.monthly.jump$Total)  
Monthly_smallungulate_count_jumpout<-sum(Smallungulates.monthly.jump$Total == 0)/length(Smallungulates.monthly.jump$Total)  
#Hourly ungulate count for underpasses
Hourly_bigungulate_count_underpass<-sum(Bigungulates.hourly.under$Total == 0)/length(Bigungulates.hourly.under$Total)  
Hourly_smallungulate_count_underpass<-sum(Smallungulates.hourly.under$Total == 0)/length(Smallungulates.hourly.under$Total)  
#Hourly ungulate count for jumpouts
Hourly_bigungulate_count_jumpout<-sum(Bigungulates.hourly.jump$Total == 0)/length(Bigungulates.hourly.jump$Total)  
Hourly_smallungulate_count_jumpout<-sum(Smallungulates.hourly.jump$Total == 0)/length(Smallungulates.hourly.jump$Total)  

Table2<-rbind(Annual_bigungulate_count_jumpout, Annual_bigungulate_count_underpass, Monthly_bigungulate_count_jumpout, Monthly_bigungulate_count_underpass, 
      Hourly_bigungulate_count_jumpout, Hourly_bigungulate_count_underpass, Annual_smallungulate_count_jumpout, Annual_smallungulate_count_underpass, Monthly_smallungulate_count_jumpout, Monthly_smallungulate_count_underpass, 
      Hourly_smallungulate_count_jumpout, Hourly_smallungulate_count_underpass)
Table2<-round(Table2, digits=2)
colnames(Table2)[1]  <- "Proportion of zeros"
kable(Table2, caption="Number of zeros in the dataset divided by the dataset sample size")

```

# Check for autocorrelation
## Run Box-Pierce and Ljung-Box test on the raw data
## Build a model of the mean (lm(count~1)) and run Durbin Watson test to test residuals
## Look at the variance and the mean

## Annual big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.ann.count.jump<-Bigcarnivores.annual.jump$Total
Bigcar.ann.count.jump.mod <- lm(Bigcar.ann.count.jump ~ 1)
dwtest(Bigcar.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.ann.count.jump, xlab="Lag" , main="Total big carnivore annual count for jumpouts") #plot acf
Bigcarnivores.annual.jump <- Bigcarnivores.annual.jump[order(Bigcarnivores.annual.jump$Year),] 
plot(x=Bigcarnivores.annual.jump$Year, y=Bigcarnivores.annual.jump$Total,
     xlab="Year", 
     ylab="Total big carnivore annual count for jumpouts", type="l",
     main="Figure 14")
var(Bigcar.ann.count.jump)
mean(Bigcar.ann.count.jump)
```

## Annual small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.ann.count.jump<-Smallcarnivores.annual.jump$Total
Smallcar.ann.count.jump.mod <- lm(Smallcar.ann.count.jump ~ 1)
dwtest(Smallcar.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.ann.count.jump, xlab="Lag", main="Figure 15: Total small carnivore annual count for jumpouts") #plot acf
Smallcarnivores.annual.jump <- Smallcarnivores.annual.jump[order(Smallcarnivores.annual.jump$Year),] 
plot(x=Smallcarnivores.annual.jump$Year, y=Smallcarnivores.annual.jump$Total,
     xlab="Year", 
     ylab="Total small carnivore annual count for jumpouts", type="l",
     main="Figure 16")
var(Smallcar.ann.count.jump)
mean(Smallcar.ann.count.jump)
```

## Annual big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.ann.count.under<-Bigcarnivores.annual.under$Total
Bigcar.ann.count.under.mod <- lm(Bigcar.ann.count.under ~ 1)
dwtest(Bigcar.ann.count.under.mod) #not autocorrelated
Box.test(Bigcar.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.ann.count.under,  xlab="Lag",
    main="Figure 17: Total big carnivore annual count for underpasses")
Bigcarnivores.annual.under <- Bigcarnivores.annual.under[order(Bigcarnivores.annual.under$Year),] 
plot(x=Bigcarnivores.annual.under$Year, y=Bigcarnivores.annual.under$Total,
     xlab="Year",
     ylab="Total big carnivore annual count for underpasses", type="l",
     main="Figure 18")
var(Bigcar.ann.count.under)
mean(Bigcar.ann.count.under)
```

## Annual small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.ann.count.under<-Smallcarnivores.annual.under$Total
Smallcar.ann.count.under.mod <- lm(Smallcar.ann.count.under ~ 1)
dwtest(Smallcar.ann.count.under.mod) #not autocorrelated
Box.test(Smallcar.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.ann.count.under, xlab="Lag",
    main="Figure 19: Total small carnivore annual count for underpasses")
Smallcarnivores.annual.under <- Smallcarnivores.annual.under[order(Smallcarnivores.annual.under$Year),] 
plot(x=Smallcarnivores.annual.under$Year, y=Smallcarnivores.annual.under$Total,
     xlab="Year",
     ylab="Total small carnivore annual count for underpasses", type="l",
     main="Figure 20")
var(Smallcar.ann.count.under)
mean(Smallcar.ann.count.under)
```

## Monthly big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.mon.count.jump<-Bigcarnivores.monthly.jump$Total
Bigcar.mon.count.jump.mod <- lm(Bigcar.mon.count.jump ~ 1)
dwtest(Bigcar.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.mon.count.jump, xlab="Lag",
    main="Figure 21:Total big carnivore monthly count for jumpouts") #plot acf
Bigcarnivores.monthly.jump <- Bigcarnivores.monthly.jump[order(Bigcarnivores.monthly.jump$Month),] 
plot(x=Bigcarnivores.monthly.jump$Month, y=Bigcarnivores.monthly.jump$Total,
     xlab="Month",
     ylab="Total big carnivore monthly count for jumpouts", type="l",
     main="Figure 22")
var(Bigcar.mon.count.jump)
mean(Bigcar.mon.count.jump)
```

## Monthly small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.mon.count.jump<-Smallcarnivores.monthly.jump$Total
Smallcar.mon.count.jump.mod <- lm(Smallcar.mon.count.jump ~ 1)
dwtest(Smallcar.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.mon.count.jump, xlab="Lag",
    main="Figure 23:Total small carnivore monthly count for jumpouts") #plot acf
Smallcarnivores.monthly.jump <- Smallcarnivores.monthly.jump[order(Smallcarnivores.monthly.jump$Month),] 
plot(x=Smallcarnivores.monthly.jump$Month, y=Smallcarnivores.monthly.jump$Total,
     xlab="Month",
     ylab="Total small carnivore monthly for jumpouts", type="l",
     main="Figure 24")
var(Smallcar.mon.count.jump)
mean(Smallcar.mon.count.jump)
```

## Monthly big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.mon.count.under<-Bigcarnivores.monthly.under$Total
Bigcar.mon.count.under.mod <- lm(Bigcar.mon.count.under ~ 1)
dwtest(Bigcar.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.mon.count.under, xlab="Lag",
    main="Figure 25:Total big carnivore monthly count for underpasses") #plot acf
Bigcarnivores.monthly.under <- Bigcarnivores.monthly.under[order(Bigcarnivores.monthly.under$Month),] 
plot(x=Bigcarnivores.monthly.under$Month, y=Bigcarnivores.monthly.under$Total,
     xlab="Month",
     ylab="Total big carnivore monthly count for underpasses", type="l",
     main="Figure 26")
var(Bigcar.mon.count.under)
mean(Bigcar.mon.count.under)
```

## Monthly small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.mon.count.under<-Smallcarnivores.monthly.under$Total
Smallcar.mon.count.under.mod <- lm(Smallcar.mon.count.under ~ 1)
dwtest(Smallcar.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.mon.count.under, xlab="Lag",
    main="Figure 27:Total small carnivore monthly count for underpasses") #plot acf
Smallcarnivores.monthly.under <- Smallcarnivores.monthly.under[order(Smallcarnivores.monthly.under$Month),] 
plot(x=Smallcarnivores.monthly.under$Month, y=Smallcarnivores.monthly.under$Total,
     xlab="Month",
     ylab="Total small carnivore monthly count for underpasses", type="l",
     main="Figure 28")
var(Smallcar.mon.count.under)
mean(Smallcar.mon.count.under)
```

## Hourly big carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigcar.hou.count.jump<-Bigcarnivores.hourly.jump$Total
Bigcar.hou.count.jump.mod <- lm(Bigcar.hou.count.jump ~ 1)
dwtest(Bigcar.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.hou.count.jump, xlab="Lag",
    main="Figure 29:Total big carnivore hourly count for jumpouts") #plot acf
Bigcarnivores.hourly.jump <- Bigcarnivores.hourly.jump[order(Bigcarnivores.hourly.jump$HourEnding),] 
plot(x=Bigcarnivores.hourly.jump$HourEnding, y=Bigcarnivores.hourly.jump$Total,
     xlab="Hour",
     ylab="Total big carnivore hourly count for jumpouts", type="l",
     main="Figure 30")
var(Bigcar.hou.count.jump)
mean(Bigcar.hou.count.jump)
```

## Hourly small carnivore count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallcar.hou.count.jump<-Smallcarnivores.hourly.jump$Total
Smallcar.hou.count.jump.mod <- lm(Smallcar.hou.count.jump ~ 1)
dwtest(Smallcar.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.hou.count.jump, xlab="Lag",
    main="Figure 31:Total small carnivore hourly count for jumpouts") #plot acf
Smallcarnivores.hourly.jump <- Smallcarnivores.hourly.jump[order(Smallcarnivores.hourly.jump$HourEnding),] 
plot(x=Smallcarnivores.hourly.jump$HourEnding, y=Smallcarnivores.hourly.jump$Total,
     xlab="Hour",
     ylab="Total small carnivore hourly count for jumpouts", type="l",
     main="Figure 32")
var(Smallcar.hou.count.jump)
mean(Smallcar.hou.count.jump)
```

## Hourly big carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigcar.hou.count.under<-Bigcarnivores.hourly.under$Total
Bigcar.hou.count.under.mod <- lm(Bigcar.hou.count.under ~ 1)
dwtest(Bigcar.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigcar.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigcar.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigcar.hou.count.under, xlab="Lag",
    main="Figure 33:Total big carnivore hourly count for underpasses") #plot acf
Bigcarnivores.hourly.under <- Bigcarnivores.hourly.under[order(Bigcarnivores.hourly.under$HourEnding),] 
plot(x=Bigcarnivores.hourly.under$HourEnding, y=Bigcarnivores.hourly.under$Total,
     xlab="Hour",
     ylab="Total big carnivore hourly count for underpasses", type="l",
     main="Figure 34")
var(Bigcar.hou.count.under)
mean(Bigcar.hou.count.under)
```

##Hourly small carnivore count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallcar.hou.count.under<-Smallcarnivores.hourly.under$Total
Smallcar.hou.count.under.mod <- lm(Smallcar.hou.count.under ~ 1)
dwtest(Smallcar.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallcar.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallcar.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallcar.hou.count.under, xlab="Lag",
    main="Figure 35:Total small carnivore hourly count for underpasses") #plot acf
Smallcarnivores.hourly.under <- Smallcarnivores.hourly.under[order(Smallcarnivores.hourly.under$HourEnding),] 
plot(x=Smallcarnivores.hourly.under$HourEnding, y=Smallcarnivores.hourly.under$Total,
     xlab="Hour",
     ylab="Total small carnivore hourly count for underpasses", type="l",
     main="Figure 36")
var(Smallcar.hou.count.under)
mean(Smallcar.hou.count.under)
```

## Annual big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.ann.count.jump<-Bigungulates.annual.jump$Total
Bigung.ann.count.jump.mod <- lm(Bigung.ann.count.jump ~ 1)
dwtest(Bigung.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.ann.count.jump, xlab="Lag",
    main="Figure 37:Total small carnivore hourly count for jumpouts") #plot acf
Bigungulates.annual.jump <- Bigungulates.annual.jump[order(Bigungulates.annual.jump$Year),] 
plot(x=Bigungulates.annual.jump$Year, y=Bigungulates.annual.jump$Total,
     xlab="Year",
     ylab="Total big ungulates annual count for jumpouts", type="l",
     main="Figure 38")
var(Bigung.ann.count.jump)
mean(Bigung.ann.count.jump)
```

## Annual small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.ann.count.jump<-Smallungulates.annual.jump$Total
Smallung.ann.count.jump.mod <- lm(Smallung.ann.count.jump ~ 1)
dwtest(Smallung.ann.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.ann.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.ann.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.ann.count.jump, xlab="Lag",
    main="Figure 39:Total small ungulates annual count for jumpouts") #plot acf
Smallungulates.annual.jump <- Smallungulates.annual.jump[order(Smallungulates.annual.jump$Year),] 
plot(x=Smallungulates.annual.jump$Year, y=Smallungulates.annual.jump$Total,
     xlab="Year",
     ylab="Total small ungulates annual count for jumpouts", type="l",
     main="Figure 40")
var(Smallung.ann.count.jump)
mean(Smallung.ann.count.jump)
```

## Annual big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.ann.count.under<-Bigungulates.annual.under$Total
Bigung.ann.count.under.mod <- lm(Bigung.ann.count.under ~ 1)
dwtest(Bigung.ann.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.ann.count.under, xlab="Lag",
    main="Figure 41:Total big ungulates annual count for underpasses") #plot acf
Bigungulates.annual.under <- Bigungulates.annual.under[order(Bigungulates.annual.under$Year),] 
plot(x=Bigungulates.annual.under$Year, y=Bigungulates.annual.under$Total,
     xlab="Year",
     ylab="Total big ungulates annual count for underpasses", type="l",
     main="Figure 42")
var(Bigung.ann.count.under)
mean(Bigung.ann.count.under)
```

## Annual small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.ann.count.under<-Smallungulates.annual.under$Total
Smallung.ann.count.under.mod <- lm(Smallung.ann.count.under ~ 1)
dwtest(Smallung.ann.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.ann.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.ann.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.ann.count.under, xlab="Lag",
    main="Figure 43:Total small ungulates annual count for underpasses") #plot acf
Smallungulates.annual.under <- Smallungulates.annual.under[order(Smallungulates.annual.under$Year),] 
plot(x=Smallungulates.annual.under$Year, y=Smallungulates.annual.under$Total,
     xlab="Year",
     ylab="Total small ungulates annual count for underpasses", type="l",
     main="Figure 44")
var(Smallung.ann.count.under)
mean(Smallung.ann.count.under)
```

## Monthly big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.mon.count.jump<-Bigungulates.monthly.jump$Total
Bigung.mon.count.jump.mod <- lm(Bigung.mon.count.jump ~ 1)
dwtest(Bigung.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.mon.count.jump, xlab="Lag",
    main="Figure 45:Total big ungulates monthly count for jumpouts") #plot acf
Bigungulates.monthly.jump <- Bigungulates.monthly.jump[order(Bigungulates.monthly.jump$Month),] 
plot(x=Bigungulates.monthly.jump$Month, y=Bigungulates.monthly.jump$Total,
     xlab="Month",
     ylab="Total big ungulates monthly count for jumpouts", type="l",
     main="Figure 46")
var(Bigung.mon.count.jump)
mean(Bigung.mon.count.jump)
```

## Monthly small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.mon.count.jump<-Smallungulates.monthly.jump$Total
Smallung.mon.count.jump.mod <- lm(Smallung.mon.count.jump ~ 1)
dwtest(Smallung.mon.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.mon.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.mon.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.mon.count.jump, xlab="Lag",
    main="Figure 47:Total small ungulates monthly count for jumpouts") #plot acf
Smallungulates.monthly.jump <- Smallungulates.monthly.jump[order(Smallungulates.monthly.jump$Month),] 
plot(x=Smallungulates.monthly.jump$Month, y=Smallungulates.monthly.jump$Total,
     xlab="Month",
     ylab="Total small ungulates monthly count for jumpouts", type="l",
     main="Figure 48")
var(Smallung.mon.count.jump)
mean(Smallung.mon.count.jump)
```

## Monthly big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.mon.count.under<-Bigungulates.monthly.under$Total
Bigung.mon.count.under.mod <- lm(Bigung.mon.count.under ~ 1)
dwtest(Bigung.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.mon.count.under, xlab="Lag",
    main="Figure 49:Total big ungulates monthly count for underpasses") #plot acf
Bigungulates.monthly.under <- Bigungulates.monthly.under[order(Bigungulates.monthly.under$Month),] 
plot(x=Bigungulates.monthly.under$Month, y=Bigungulates.monthly.under$Total,
     xlab="Month",
     ylab="Total big ungulates monthly count for underpasses", type="l",
     main="Figure 50")
var(Bigung.mon.count.under)
mean(Bigung.mon.count.under)
```

## Monthly small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.mon.count.under<-Smallungulates.monthly.under$Total
Smallung.mon.count.under.mod <- lm(Smallung.mon.count.under ~ 1)
dwtest(Smallung.mon.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.mon.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.mon.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.mon.count.under, xlab="Lag",
    main="Figure 51:Total small ungulates monthly count for underpasses") #plot acf
Smallungulates.monthly.under <- Smallungulates.monthly.under[order(Smallungulates.monthly.under$Month),] 
plot(x=Smallungulates.monthly.under$Month, y=Smallungulates.monthly.under$Total,
     xlab="Month",
     ylab="Total small ungulates monthly count for underpasses", type="l",
     main="Figure 52")
var(Smallung.mon.count.under)
mean(Smallung.mon.count.under)
```

## Hourly big ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Bigung.hou.count.jump<-Bigungulates.hourly.jump$Total
Bigung.hou.count.jump.mod <- lm(Bigung.hou.count.jump ~ 1)
dwtest(Bigung.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.hou.count.jump, xlab="Lag",
    main="Figure 53:Total big ungulates hourly count for jumpouts") #plot acf
Bigungulates.hourly.jump <- Bigungulates.hourly.jump[order(Bigungulates.hourly.jump$HourEnding),] 
plot(x=Bigungulates.hourly.jump$HourEnding, y=Bigungulates.hourly.jump$Total,
     xlab="Hour",
     ylab="Total big ungulates hourly count for jumpouts", type="l",
     main="Figure 54")
var(Bigung.hou.count.jump)
mean(Bigung.hou.count.jump)
```

## Hourly small ungulate count for jumpouts

```{r, eval=TRUE, echo=FALSE}
Smallung.hou.count.jump<-Smallungulates.hourly.jump$Total
Smallung.hou.count.jump.mod <- lm(Smallung.hou.count.jump ~ 1)
dwtest(Smallung.hou.count.jump.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.hou.count.jump, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.hou.count.jump, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.hou.count.jump, xlab="Lag",
    main="Figure 55:Total small ungulates hourly count for jumpouts") #plot acf
Smallungulates.hourly.jump <- Smallungulates.hourly.jump[order(Smallungulates.hourly.jump$HourEnding),] 
plot(x=Smallungulates.hourly.jump$HourEnding, y=Smallungulates.hourly.jump$Total,
     xlab="Hour",
     ylab="Total small ungulates hourly count for jumpouts", type="l",
     main="Figure 56")
var(Smallung.hou.count.jump)
mean(Smallung.hou.count.jump)
```

## Hourly big ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Bigung.hou.count.under<-Bigungulates.hourly.under$Total
Bigung.hou.count.under.mod <- lm(Bigung.hou.count.under ~ 1)
dwtest(Bigung.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Bigung.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Bigung.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Bigung.hou.count.under, xlab="Lag",
    main="Figure 57:Total big ungulates hourly count for underpasses") #plot acf
Bigungulates.hourly.under <- Bigungulates.hourly.under[order(Bigungulates.hourly.under$HourEnding),] 
plot(x=Bigungulates.hourly.under$HourEnding, y=Bigungulates.hourly.under$Total,
     xlab="Hour",
     ylab="Total big ungulates hourly count for underpasses", type="l",
     main="Figure 58")
var(Bigung.hou.count.under)
mean(Bigung.hou.count.under)
```

## Hourly small ungulate count for underpasses

```{r, eval=TRUE, echo=FALSE}
Smallung.hou.count.under<-Smallungulates.hourly.under$Total
Smallung.hou.count.under.mod <- lm(Smallung.hou.count.under ~ 1)
dwtest(Smallung.hou.count.under.mod) #DW test (tests the residuals)-not autocorrelated
Box.test(Smallung.hou.count.under, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Smallung.hou.count.under, lag = 1, type = c("Ljung-Box"), fitdf = 0)
acf(Smallung.hou.count.under, xlab="Lag",
    main="Figure 59:Total small ungulates hourly count for underpasses") #plot acf
Smallungulates.hourly.under <- Smallungulates.hourly.under[order(Smallungulates.hourly.under$HourEnding),] 
plot(x=Smallungulates.hourly.under$HourEnding, y=Smallungulates.hourly.under$Total,
     xlab="Hour",
     ylab="Total small ungulates hourly count for underpasses", type="l",
     main="Figure 60")
var(Smallung.hou.count.under)
mean(Smallung.hou.count.under)
```

# Look at whether there is circularity in the dataset

```{r, echo=FALSE}
#Setup the data differently, get frequencies of count for hour/month/year
newdata<-read.csv("/Users/hannahedwards/Documents/Alberta Parks/Crossing-structures/data/newdata_bodymass.csv")

#Split by species and then crossing structure
smallungulates.under<-subset(newdata, newdata$Species.body.mass == "Small ungulate" &
                                 newdata$Underpass.type == "Underpass")
bigungulates.under<-subset(newdata, newdata$Species.body.mass == "Big ungulate" &
                                 newdata$Underpass.type == "Underpass")
smallungulates.jump<-subset(newdata, newdata$Species.body.mass == "Small ungulate" &
                                 newdata$Underpass.type == "Jumpout")
bigungulates.jump<-subset(newdata, newdata$Species.body.mass == "Big ungulate" &
                                 newdata$Underpass.type == "Jumpout")

smallcarnivores.under<-subset(newdata, newdata$Species.body.mass == "Small carnivore" &
                                 newdata$Underpass.type == "Underpass")
bigcarnivores.under<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                                 newdata$Underpass.type == "Underpass")
smallcarnivores.jump<-subset(newdata, newdata$Species.body.mass == "Small carnivore" &
                          newdata$Underpass.type == "Jumpout")
bigcarnivores.jump<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                          newdata$Underpass.type == "Jumpout")
carnivores<-subset(newdata, newdata$Species.body.mass == "Big carnivore" &
                     newdata$Species.body.mass == "Small carnivore")

Bobcat<-subset(newdata, newdata$Species == "Bobcat")
Cougar<-subset(newdata, newdata$Species == "Cougar")
Coyote<-subset(newdata, newdata$Species == "Coyote")
GrizzlyBear<-subset(newdata, newdata$Species == "Grizzly Bear")
Lynx<-subset(newdata, newdata$Species == "Lynx")
Marten<-subset(newdata, newdata$Species == "Marten")
RedFox<-subset(newdata, newdata$Species == "Red Fox")
StripedSkunk<-subset(newdata, newdata$Species == "Striped Skunk")
UnknownBear<-subset(newdata, newdata$Species == "Unknown Bear")
Wolf<-subset(newdata, newdata$Species == "Wolf")
Wolverine<-subset(newdata, newdata$Species == "Wolverine")
BlackBear<-subset(newdata, newdata$Species == "Black Bear")
```

## Ungulate and carnivore hours of activity

```{r, eval=TRUE, echo=FALSE}
#Make data circular with hourending
#Vector
#Underpass
bigunghourunder<-bigungulates.under$HourEnding
smallunghourunder<-smallungulates.under$HourEnding
bigcarhourunder<-bigcarnivores.under$HourEnding
smallcarhourunder<-smallcarnivores.under$HourEnding
bigunghourunderc <- circular(bigunghourunder, units="hours", template="clock24")
smallunghourunderc <- circular(smallunghourunder, units="hours", template="clock24")
bigcarhourunderc <- circular(bigcarhourunder, units="hours", template="clock24")
smallcarhourunderc <- circular(smallcarhourunder, units="hours", template="clock24")
#Jumpout
bigunghourjump<-bigungulates.jump$HourEnding
smallunghourjump<-smallungulates.jump$HourEnding
bigcarhourjump<-bigcarnivores.jump$HourEnding
smallcarhourjump<-smallcarnivores.jump$HourEnding
bigunghourjumpc <- circular(bigunghourjump, units="hours", template="clock24")
smallunghourjumpc <- circular(smallunghourjump, units="hours", template="clock24")
bigcarhourjumpc <- circular(bigcarhourjump, units="hours", template="clock24")
smallcarhourjumpc <- circular(smallcarhourjump, units="hours", template="clock24")
#the radius of a segment is taken to be the square root of the relative frequency
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigunghourunderc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(bigunghourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate hour frequency underpasses", main="Figure 61")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallunghourunderc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(smallunghourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate hour frequency underpasses", main="Figure 62")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigunghourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(bigunghourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate hour frequency jumpouts", main="Figure 63")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallunghourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
a<-rose.diag(smallunghourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate hour frequency jumpouts", main="Figure 64")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarhourunderc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(bigcarhourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore hour frequency underpasses", main="Figure 65")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarhourunderc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(smallcarhourunderc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore hour frequency underpasses", main="Figure 66")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarhourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(bigcarhourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore hour frequency jumpouts", main="Figure 67")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarhourjumpc)
```
```{r, eval=TRUE, echo=FALSE}
b<-rose.diag(smallcarhourjumpc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore hour frequency jumpouts", main="Figure 68")
```

## Ungulate and carnivore months of activity

```{r, eval=TRUE, echo=FALSE}
#Make data circular with Month
#Underpass
bigungmonunder<-bigungulates.under$Month
smallungmonunder<-smallungulates.under$Month
bigcarmonunder<-bigcarnivores.under$Month
smallcarmonunder<-smallcarnivores.under$Month
bigungmonunderc <- circular(bigungmonunder, units="hours", template="clock12")
smallungmonunderc <- circular(smallungmonunder, units="hours", template="clock12")
bigcarmonunderc <- circular(bigcarmonunder, units="hours", template="clock12")
smallcarmonunderc <- circular(smallcarmonunder, units="hours", template="clock12")
#Jumpout
bigungmonjump<-bigungulates.jump$Month
smallungmonjump<-smallungulates.jump$Month
bigcarmonjump<-bigcarnivores.jump$Month
smallcarmonjump<-smallcarnivores.jump$Month
bigungmonjumpc <- circular(bigungmonjump, units="hours", template="clock12")
smallungmonjumpc <- circular(smallungmonjump, units="hours", template="clock12")
bigcarmonjumpc <- circular(bigcarmonjump, units="hours", template="clock12")
smallcarmonjumpc <- circular(smallcarmonjump, units="hours", template="clock12")

#the radius of a segment is taken to be the square root of the relative frequency
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigungmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(bigungmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulate month frequency jumpouts", main="Figure 69")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallungmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(smallungmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulate month frequency jumpouts", main="Figure 70")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigungmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigungmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big ungulates month frequency underpasses", main="Figure 71")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallungmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallungmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small ungulates month frequency underpasses", main="Figure 72")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigcarmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore month frequency jumpouts", main="Figure 73")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarmonjumpc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallcarmonjumpc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore month frequency jumpouts", main="Figure 74")
```
```{r, echo=FALSE, fig.show='hide'}
plot(bigcarmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(bigcarmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Big carnivore month frequency underpasses", main="Figure 75")
```
```{r, echo=FALSE, fig.show='hide'}
plot(smallcarmonunderc)
```
```{r, eval=TRUE, echo=FALSE}
d<-rose.diag(smallcarmonunderc, bins=12, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Small carnivore month frequency underpasses", main="Figure 76")
```


## Carnivores hours of activity separated by species

```{r, eval=TRUE, echo=FALSE}
#Make data circular with hour for each carnivore species
carnivores$Species<-as.factor(carnivores$Species)

#Bobcat
Bobcathou<-Bobcat$HourEnding
Bobcathouc <- circular(Bobcathou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Bobcathouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Bobcathouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Bobcat hour frequency", main="Figure 77")
```
```{r, eval=TRUE, echo=FALSE}
#Coyote
Coyotehou<-Coyote$HourEnding
Coyotehouc <- circular(Coyotehou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Coyotehouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Coyotehouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Coyote hour frequency", main="Figure 78")
```
```{r, eval=TRUE, echo=FALSE}
#Cougar
Cougarhou<-Cougar$HourEnding
Cougarhouc <- circular(Cougarhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Cougarhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Cougarhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Cougar hour frequency", main="Figure 79")
```
```{r, eval=TRUE, echo=FALSE}
#Grizzly Bear
GrizzlyBearhou<-GrizzlyBear$HourEnding
GrizzlyBearhouc <- circular(GrizzlyBearhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(GrizzlyBearhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(GrizzlyBearhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Grizzly Bear hour frequency", main="Figure 80")
```
```{r, eval=TRUE, echo=FALSE}
#Lynx
Lynxhou<-Lynx$HourEnding
Lynxhouc <- circular(Lynxhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Lynxhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Lynxhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Lynx hour frequency", main="Figure 81")
```
```{r, eval=TRUE, echo=FALSE}
#Marten
Martenhou<-Marten$HourEnding
Martenhouc <- circular(Martenhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Martenhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Martenhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Pine Marten hour frequency", main="Figure 82")
```
```{r, eval=TRUE, echo=FALSE}
#RedFox
RedFoxhou<-RedFox$HourEnding
RedFoxhouc <- circular(RedFoxhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(RedFoxhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(RedFoxhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Red Fox hour frequency", main="Figure 83")
```
```{r, eval=TRUE, echo=FALSE}
#StripedSkunk
StripedSkunkhou<-StripedSkunk$HourEnding
StripedSkunkhouc <- circular(StripedSkunkhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(StripedSkunkhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(StripedSkunkhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Striped Skunk hour frequency", main="Figure 84")
```
```{r, eval=TRUE, echo=FALSE}
#UnknownBear
UnknownBearhou<-UnknownBear$HourEnding
UnknownBearhouc <- circular(UnknownBearhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(UnknownBearhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(UnknownBearhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Unknown Bear hour frequency", main="Figure 85")
```
```{r, eval=TRUE, echo=FALSE}
#Wolf
Wolfhou<-Wolf$HourEnding
Wolfhouc <- circular(Wolfhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Wolfhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Wolfhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Wolf hour frequency", main="Figure 86")
```
```{r, eval=TRUE, echo=FALSE}
#Wolverine
Wolverinehou<-Wolverine$HourEnding
Wolverinehouc <- circular(Wolverinehou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(Wolverinehouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(Wolverinehouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Wolverine hour frequency", main="Figure 87")
```
```{r, eval=TRUE, echo=FALSE}
#Black bear
BlackBearhou<-BlackBear$HourEnding
BlackBearhouc <- circular(BlackBearhou, units="hours", template="clock24")
```
```{r, echo=FALSE, fig.show='hide'}
plot(BlackBearhouc)
```
```{r, eval=TRUE, echo=FALSE}
c<-rose.diag(BlackBearhouc, bins=24, col="darkgrey", cex=1.5, prop=1.3, add=FALSE,
             xlab="Black Bear hour frequency", main="Figure 88")
```